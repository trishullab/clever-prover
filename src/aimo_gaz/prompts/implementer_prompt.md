The instructions below describe a coding problem statement with a corresponding Lean 4 problem spec, function implementation signature, and test cases.

Along with these is a detailed plan with steps of how to implement the Lean 4 function to solve this problem.

Please write for me an implementation of this Lean 4 function to solve this problem, starting with the function implementation signature below.

Please respond entirely in Lean 4.

--------------------------------------------------

[PROBLEM STATEMENT]

[END]

[PROBLEM SPEC]

[END]

[FUNCTION IMPLEMENTATION SIGNATURE]

[END]

[TEST CASES]

[END]

[PLAN]

[END]