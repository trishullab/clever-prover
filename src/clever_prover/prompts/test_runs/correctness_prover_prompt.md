The instructions below describe a coding problem statement with a corresponding Lean 4 problem spec, a function implementation, a list of zero or more previously-proven lemmas about the function implementation (with their proofs omitted), and a correctness definition.

Along with these is a detailed plan with steps of how to prove the correctness definition in Lean 4 stating that the given function implementation follows the required problem spec.

Please write for me a Lean 4 proof of the correctness definition, starting with the correctness theorem statement. You may freely use any of the lemmas in your proof.

Please respond entirely in Lean 4.

--------------------------------------------------

[PROBLEM STATEMENT]

[END]

[PROBLEM SPEC]

[END]

[FUNCTION IMPLEMENTATION]

[END]

[LEMMAS]

[END]

[CORRECTNESS DEFINITION]

[END]

[PLAN]

[END]